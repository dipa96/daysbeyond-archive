
# CVE-2021-43849

cordova-plugin-fingerprint-aio is a plugin provides a single and simple interface for accessing fingerprint APIs. In versions prior to 5.0.1 the exported activity `de.niklasmerz.cordova.biometric.BiometricActivity` can cause the app to crash. This vulnerability occurred because the activity didn't handle the case where it is requested with invalid or empty data which results in a crash.

 *Any third party app can constantly call this activity with no permission. A 3rd party app/attacker using event listener can continually stop the app from working and make the victim unable to open it.*

## PoC (Proof of Concept)

```zsh
adb shell am start -n de.niklasmerz.cordova.biometric/.BiometricActivity -e "" ""
```

**Expected result**: App will crash

## In Depth

The `android:exported` attribute sets whether other apps can launch one of your app's components (activity, service, content provider, or broadcast receiver): If `true` , any app can access the app component. If you set an activity's `android:exported` attribute to `true` , another app can launch it by its exact class name. In this case we can send data from outside to the `BiometricActivity`. Sending **empty data** will cause the application to crash and exploit **Denial of Service(DoS)** vulnerabilities.

### Vulnerable Code

```xml
<activity android:name="de.niklasmerz.cordova.biometric.BiometricActivity" android:theme="@style/TransparentTheme" android:exported="true"/>
```

## Remediation

Version 5.0.1 of the cordova-plugin-fingerprint-aio doesn't export the activity anymore and is no longer vulnerable.

### Sanitized code

If you want to fix older versions change the attribute `android:exported` of this code snippet in `plugin.xml` to false as below.

```xml
<config-file target="AndroidManifest.xml" parent="application">
      <activity android:name="de.niklasmerz.cordova.biometric.BiometricActivity" android:theme="@style/TransparentTheme" android:exported="false"/>
</config-file>
```

## Reference

[mitre.org | CVE-2021-43849](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-43849)
[owasp.org | Denial of Service(DoS)](https://owasp.org/www-community/attacks/Denial_of_Service)
